<!DOCTYPE html>
<html lang="en" data-theme="macchiato">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Modern Weather.sg</title>
    
    <!-- PWA Primary Meta Tags -->
    <meta name="theme-color" content="#24273a">
    <meta name="description" content="Modern view of Singapore weather nowcast, rain radar, and flood alerts.">
    
    <!-- Manifest: Using standard .json with explicit versioning -->
    <link rel="manifest" href="./manifest.json?v=14">
    
    <!-- Android / Chrome Support -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Weather.sg">
    
    <!-- iOS / Safari Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Weather.sg">
    <!-- Use local icon for reliable loading -->
    <link rel="icon" type="image/svg+xml" href="./icon.svg">
    <link rel="apple-touch-icon" href="./icon.svg">

    <!-- Theme Initialization Script (Blocking to prevent FOUC) -->
    <script>
      (function() {
        try {
          const storedTheme = localStorage.getItem('catppuccin-theme');
          const theme = storedTheme || 'macchiato';
          document.documentElement.setAttribute('data-theme', theme);
          
          // Update meta theme-color based on theme
          const metaThemeColor = document.querySelector('meta[name="theme-color"]');
          if (metaThemeColor) {
            metaThemeColor.setAttribute('content', theme === 'latte' ? '#eff1f5' : '#24273a');
          }
        } catch (e) {}
      })();
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: ['class', '[data-theme="macchiato"]'], // Optional explicit mode
        theme: {
          extend: {
            colors: {
              base: 'rgb(var(--base-rgb) / <alpha-value>)',
              mantle: 'rgb(var(--mantle-rgb) / <alpha-value>)',
              crust: 'rgb(var(--crust-rgb) / <alpha-value>)',
              text: 'rgb(var(--text-rgb) / <alpha-value>)',
              subtext0: 'rgb(var(--subtext0-rgb) / <alpha-value>)',
              subtext1: 'rgb(var(--subtext1-rgb) / <alpha-value>)',
              surface0: 'rgb(var(--surface0-rgb) / <alpha-value>)',
              surface1: 'rgb(var(--surface1-rgb) / <alpha-value>)',
              surface2: 'rgb(var(--surface2-rgb) / <alpha-value>)',
              overlay0: 'rgb(var(--overlay0-rgb) / <alpha-value>)',
              overlay1: 'rgb(var(--overlay1-rgb) / <alpha-value>)',
              overlay2: 'rgb(var(--overlay2-rgb) / <alpha-value>)',
              blue: 'rgb(var(--blue-rgb) / <alpha-value>)',
              lavender: 'rgb(var(--lavender-rgb) / <alpha-value>)',
              sapphire: 'rgb(var(--sapphire-rgb) / <alpha-value>)',
              sky: 'rgb(var(--sky-rgb) / <alpha-value>)',
              teal: 'rgb(var(--teal-rgb) / <alpha-value>)',
              green: 'rgb(var(--green-rgb) / <alpha-value>)',
              yellow: 'rgb(var(--yellow-rgb) / <alpha-value>)',
              peach: 'rgb(var(--peach-rgb) / <alpha-value>)',
              maroon: 'rgb(var(--maroon-rgb) / <alpha-value>)',
              red: 'rgb(var(--red-rgb) / <alpha-value>)',
              mauve: 'rgb(var(--mauve-rgb) / <alpha-value>)',
              pink: 'rgb(var(--pink-rgb) / <alpha-value>)',
              flamingo: 'rgb(var(--flamingo-rgb) / <alpha-value>)',
              rosewater: 'rgb(var(--rosewater-rgb) / <alpha-value>)',
            },
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
            }
          }
        }
      }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Catppuccin Macchiato & Latte Variables */
        :root {
            /* Macchiato (Default) */
            --ctp-macchiato-rosewater-rgb: 244 219 214;
            --ctp-macchiato-flamingo-rgb: 240 198 198;
            --ctp-macchiato-pink-rgb: 245 189 230;
            --ctp-macchiato-mauve-rgb: 198 160 246;
            --ctp-macchiato-red-rgb: 237 135 150;
            --ctp-macchiato-maroon-rgb: 238 153 160;
            --ctp-macchiato-peach-rgb: 245 169 127;
            --ctp-macchiato-yellow-rgb: 238 212 159;
            --ctp-macchiato-green-rgb: 166 218 149;
            --ctp-macchiato-teal-rgb: 139 213 202;
            --ctp-macchiato-sky-rgb: 145 215 227;
            --ctp-macchiato-sapphire-rgb: 125 196 228;
            --ctp-macchiato-blue-rgb: 138 173 244;
            --ctp-macchiato-lavender-rgb: 183 189 248;
            --ctp-macchiato-text-rgb: 202 211 245;
            --ctp-macchiato-subtext1-rgb: 184 192 224;
            --ctp-macchiato-subtext0-rgb: 165 173 203;
            --ctp-macchiato-overlay2-rgb: 147 154 183;
            --ctp-macchiato-overlay1-rgb: 128 135 162;
            --ctp-macchiato-overlay0-rgb: 110 115 141;
            --ctp-macchiato-surface2-rgb: 91 96 120;
            --ctp-macchiato-surface1-rgb: 73 77 100;
            --ctp-macchiato-surface0-rgb: 54 58 79;
            --ctp-macchiato-base-rgb: 36 39 58;
            --ctp-macchiato-mantle-rgb: 30 32 48;
            --ctp-macchiato-crust-rgb: 24 25 38;

            /* Latte */
            --ctp-latte-rosewater-rgb: 220 138 120;
            --ctp-latte-flamingo-rgb: 221 120 120;
            --ctp-latte-pink-rgb: 234 118 203;
            --ctp-latte-mauve-rgb: 136 57 239;
            --ctp-latte-red-rgb: 210 15 57;
            --ctp-latte-maroon-rgb: 230 69 83;
            --ctp-latte-peach-rgb: 254 100 11;
            --ctp-latte-yellow-rgb: 223 142 29;
            --ctp-latte-green-rgb: 64 160 43;
            --ctp-latte-teal-rgb: 23 146 153;
            --ctp-latte-sky-rgb: 4 165 229;
            --ctp-latte-sapphire-rgb: 32 159 181;
            --ctp-latte-blue-rgb: 30 102 245;
            --ctp-latte-lavender-rgb: 114 135 253;
            --ctp-latte-text-rgb: 76 79 105;
            --ctp-latte-subtext1-rgb: 92 95 119;
            --ctp-latte-subtext0-rgb: 108 111 133;
            --ctp-latte-overlay2-rgb: 124 127 147;
            --ctp-latte-overlay1-rgb: 140 143 161;
            --ctp-latte-overlay0-rgb: 156 160 176;
            --ctp-latte-surface2-rgb: 172 176 190;
            --ctp-latte-surface1-rgb: 188 192 204;
            --ctp-latte-surface0-rgb: 204 208 218;
            --ctp-latte-base-rgb: 239 241 245;
            --ctp-latte-mantle-rgb: 230 233 239;
            --ctp-latte-crust-rgb: 220 224 232;

            /* Default Theme Mapping (Macchiato) */
            --rosewater-rgb: var(--ctp-macchiato-rosewater-rgb);
            --flamingo-rgb: var(--ctp-macchiato-flamingo-rgb);
            --pink-rgb: var(--ctp-macchiato-pink-rgb);
            --mauve-rgb: var(--ctp-macchiato-mauve-rgb);
            --red-rgb: var(--ctp-macchiato-red-rgb);
            --maroon-rgb: var(--ctp-macchiato-maroon-rgb);
            --peach-rgb: var(--ctp-macchiato-peach-rgb);
            --yellow-rgb: var(--ctp-macchiato-yellow-rgb);
            --green-rgb: var(--ctp-macchiato-green-rgb);
            --teal-rgb: var(--ctp-macchiato-teal-rgb);
            --sky-rgb: var(--ctp-macchiato-sky-rgb);
            --sapphire-rgb: var(--ctp-macchiato-sapphire-rgb);
            --blue-rgb: var(--ctp-macchiato-blue-rgb);
            --lavender-rgb: var(--ctp-macchiato-lavender-rgb);
            --text-rgb: var(--ctp-macchiato-text-rgb);
            --subtext1-rgb: var(--ctp-macchiato-subtext1-rgb);
            --subtext0-rgb: var(--ctp-macchiato-subtext0-rgb);
            --overlay2-rgb: var(--ctp-macchiato-overlay2-rgb);
            --overlay1-rgb: var(--ctp-macchiato-overlay1-rgb);
            --overlay0-rgb: var(--ctp-macchiato-overlay0-rgb);
            --surface2-rgb: var(--ctp-macchiato-surface2-rgb);
            --surface1-rgb: var(--ctp-macchiato-surface1-rgb);
            --surface0-rgb: var(--ctp-macchiato-surface0-rgb);
            --base-rgb: var(--ctp-macchiato-base-rgb);
            --mantle-rgb: var(--ctp-macchiato-mantle-rgb);
            --crust-rgb: var(--ctp-macchiato-crust-rgb);
        }

        /* Latte Theme Mapping */
        [data-theme="latte"] {
            --rosewater-rgb: var(--ctp-latte-rosewater-rgb);
            --flamingo-rgb: var(--ctp-latte-flamingo-rgb);
            --pink-rgb: var(--ctp-latte-pink-rgb);
            --mauve-rgb: var(--ctp-latte-mauve-rgb);
            --red-rgb: var(--ctp-latte-red-rgb);
            --maroon-rgb: var(--ctp-latte-maroon-rgb);
            --peach-rgb: var(--ctp-latte-peach-rgb);
            --yellow-rgb: var(--ctp-latte-yellow-rgb);
            --green-rgb: var(--ctp-latte-green-rgb);
            --teal-rgb: var(--ctp-latte-teal-rgb);
            --sky-rgb: var(--ctp-latte-sky-rgb);
            --sapphire-rgb: var(--ctp-latte-sapphire-rgb);
            --blue-rgb: var(--ctp-latte-blue-rgb);
            --lavender-rgb: var(--ctp-latte-lavender-rgb);
            --text-rgb: var(--ctp-latte-text-rgb);
            --subtext1-rgb: var(--ctp-latte-subtext1-rgb);
            --subtext0-rgb: var(--ctp-latte-subtext0-rgb);
            --overlay2-rgb: var(--ctp-latte-overlay2-rgb);
            --overlay1-rgb: var(--ctp-latte-overlay1-rgb);
            --overlay0-rgb: var(--ctp-latte-overlay0-rgb);
            --surface2-rgb: var(--ctp-latte-surface2-rgb);
            --surface1-rgb: var(--ctp-latte-surface1-rgb);
            --surface0-rgb: var(--ctp-latte-surface0-rgb);
            --base-rgb: var(--ctp-latte-base-rgb);
            --mantle-rgb: var(--ctp-latte-mantle-rgb);
            --crust-rgb: var(--ctp-latte-crust-rgb);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: rgb(var(--base-rgb));
            color: rgb(var(--text-rgb));
            margin: 0;
            overflow-x: hidden;
            overscroll-behavior-y: contain;
            transition: background-color 0.3s, color 0.3s;
        }
        .glass {
            background: rgba(var(--mantle-rgb), 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(var(--subtext1-rgb), 0.1);
        }
        .weather-card {
            transition: transform 0.2s ease-in-out;
        }
        .weather-card:hover {
            transform: translateY(-4px);
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgb(var(--mantle-rgb));
        }
        ::-webkit-scrollbar-thumb {
            background: rgb(var(--surface1-rgb));
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgb(var(--surface2-rgb));
        }
    </style>

<script type="importmap">
{
  "imports": {
    "react/": "https://esm.sh/react@^19.0.0/",
    "react": "https://esm.sh/react@^19.0.0",
    "react-dom/": "https://esm.sh/react-dom@^19.0.0/",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^4.3.0",
    "vite": "https://esm.sh/vite@^6.0.0"
  }
}
</script>
  <script type="module" crossorigin src="./assets/index-B7jIjd2g.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script>
      /**
       * PWA Service Worker Registration
       * Uses a timestamp query param to strictly bypass HTTP caching for the sw.js file.
       */
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          // The 't' param forces the browser to request a fresh copy of sw.js from the server
          navigator.serviceWorker.register('./sw.js?v=14&t=' + Date.now())
            .then(reg => {
              console.log('PWA: Service Worker active (v14)');
              // Check for updates periodically
              setInterval(() => {
                reg.update();
              }, 60 * 60 * 1000);
            })
            .catch(err => {
              console.debug('PWA: Service Worker registration failed:', err.message);
            });
        });
      }
    </script>

</body>
</html>